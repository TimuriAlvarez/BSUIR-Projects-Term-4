# Personal Computer Architecture Labs

## General information

| Information |                                 |
|-------------|---------------------------------|
| Year        | 2nd                             |
| Term        | 4th                             |
| Discipline  | Personal Computer Architecture  |
| Quantity    | 8                               |
| OS          | Linux + DOS (VirtualBox)        |

# Lab 1

## Последовательный порт

### Terms of reference

Разработать программный модуль реализации процедуры передачи (приема) байта информации через последовательный интерфейс.

Программа должна демонстрировать программное взаимодействие с последовательным интерфейсом с использованием следующих механизмов:

1. прямое взаимодействие с портами ввода-вывода (write, read),
2. использование BIOS прерывания 14h,
3. работа с COM-портом через регистры как с устройством ввода-вывода.

# Lab 2-3

## Программирование контроллера прерываний

### Terms of reference

Написать резидентную программу, выполняющую перенос всех векторов аппаратных прерываний ведущего и ведомого контроллера на пользовательские прерывания. При этом необходимо написать обработчики аппаратных прерываний, которые будут установлены на используемые пользовательские прерывания и будут выполнять следующие функции:

1. Выводить на экран в двоичной форме следующие регистры контроллеров прерывания (как ведущего, так и ведомого):
   * регистр запросов на прерывания;
   * регистр обслуживаемых прерываний;
   * регистр масок.

   При этом значения регистров должны выводиться всегда в одно и то же место экрана.  
2. Осуществлять переход на стандартные обработчики аппаратных прерываний, для обеспечения нормальной работы компьютера.

# Lab 4

## Программирование системного таймера

### Terms of reference

1. Запрограммировать второй канал таймера таким образом, чтобы динамик компьютера издавал звуки.
2. 
   * Для всех каналов таймера считать слово состояния и вывести его на экран в двоичной форме. 
   * Для всех каналов таймера рассчитать коэффициент деления и вывести его на экран в шестнадцатеричной форме.


# Lab 5

## Программирование часов реального времени

### Terms of reference

В программе должно быть реализовано меню, позволяющее выбрать тестируемый функционал (установка времени, считывание времени, задержка и т.д.). Весь ввод/вывод данных с/на консоль должен выполняться в удобной для пользователя форме. Зависание компьютера не допускается ни в ходе работы программы, ни после ее завершения.

1. Написать программу, которая будет считывать и устанавливать время в часах реального времени. Считанное время должно выводиться на экран в удобочитаемой форме.
   1.	Перед началом установки новых значений времени необходимо считывать и анализировать старший байт регистра состояния 1 на предмет доступности значений для чтения и записи. Начинать операцию записи новых значений, можно только в случае, когда этот бит установлен в '0' – то есть, регистры часов доступны.
   2.	После проверки доступности регистров (пункт 1), необходимо отключить внутренний цикл обновления часов реального времени, воспользовавшись старшим битом регистра состояния 2. После окончания операции установки значений этот бит должен быть сброшен, для возобновления внутреннего цикла обновления часов реального времени.
   3.	Новые значения для регистров часов реального времени должны вводится с клавиатуры в удобном для пользователя виде.
2. Используя аппаратное прерывание часов реального времени и режим генерации периодических прерываний реализовать функцию задержки с точностью в миллисекунды.
Условия выполнения данного варианта:
   1. Задержка должна вводится с клавиатуры в миллисекундах в удобной для пользователя форме.
   2. После окончания периода задержки программа должна сообщить об этом в любой форме. При этом зависание компьютера не допускается.
3. Используя аппаратное прерывания часов реального времени и режим будильника реализовать функции программируемого будильника.
   1. Время будильника вводится с клавиатуры в удобной для пользователя форме.
   2. При срабатывании будильника программа должна сообщить об этом в любой форме. При этом зависание компьютера не допускается.

# Lab 6

## Программирование клавиатуры

### Terms of reference

Программируя клавиатуру помигать ее индикаторами. Алгоритм мигания произвольный. Условия реализации программы, необходимые для выполнения лабораторной работы:

1. Запись байтов команды должна выполняться только после проверки незанятости входного регистра контроллера клавиатуры. Проверка осуществляется считывание и анализом регистра состояния контроллера клавиатуры. 
2. Для каждого байта команды необходимо считывать и анализировать код возврата. В случае считывания кода возврата, требующего повторить передачу байта, необходимо повторно, при необходимости – несколько раз, выполнить передачу байта. При этом повторная передача данных не исключает выполнения всех оставшихся условий.
3. Для определения момента получения кода возврата необходимо использовать аппаратное прерывания от клавиатуры.
4. Все коды возврата должны быть выведены на экран в шестнадцатеричной форме.

# Lab 7

## Защищенный и реальный режим процессора. Переход из одного режима в другой и обработка прерываний

### Terms of reference

Написать программу, которая выполняет следующие действия:

1. Переход из реального режима в защищенный.
2. Перехватывает аппаратное прерывание от клавиатуры и заданное аппаратное прерывание, в обработчике которого выполняет определенные действия. Прерывание от клавиатуры реализуют все, номер аппаратного прерывания задается по вариантам (два варианта).
3. Прерывание от таймера.
4. Прерывание от часов реального времени.
5. По наступлению определенного события выполняет обратный переход из защищенного режима в реальный и завершает свою работу.

* Для прерываний от таймера и часов реального времени обработчик прерывания должен отслеживать количество вызовов прерывания и отсчитывать секунды, выводя их на экран. Количество секунд после которых выполняется обратный переход в реальный режим и выход из программы (то самое определенное событие) считывается с клавиатуры перед переходом в защищенный режим.
* Для прерывания от клавиатуры необходимо считывать скан-коды клавиш и выводить их на экран. По нажатию определенной клавиши (любой на выбор студента) осуществляется обратный переход в реальный режим и выход из программы.

При выполнении данной лабораторной работы должны быть соблюдены следующие условия:

1. После завершения работы программы компьютер должен продолжать корректно функционировать. Зависания, перезагрузки и другие аналогичные «события» недопустимы.
2. Переход в защищенный режим процессора должен быть выполнен по алгоритму, используемому в процессорах начиная с 386. Переход в защищенный режим с использованием алгоритма для 286 процессора недопустим.

# Lab 8

## Защищенный режим процессора. Мультизадачность

### Terms of reference

Написать программу, которая выполняет следующие действия:

1. Выполняет переход из реального режима в защищенный.
2. Организует минимум три задачи, переключающиеся между собой.
3. Выполняет обратный переход из защищенного режима в реальный.
4. Каждая задача должна выполнять действие, по которому можно будет сделать вывод о том, что она работает (например, одна задача выводит символы справа налево и сверху вниз, другая организует счетчик, третья выводит символы слева на право и снизу вверх).
5. Возврат в реальный режим осуществляется по нажатию на “Esc”.

   Переключение задач должно выполняться с использованием аппаратных прерываний по вариантам:
   1. Прерывание от таймера.
   2. Прерывание от часов реального времени.

* Для прерываний от таймера и часов реального времени переключение задач осуществляется через определенные промежутки времени, вводимые с клавиатуры до перехода в защищенный режим. 

При выполнении данной лабораторной работы должны быть выполнены следующие условия:

1. После завершения работы программы компьютер должен продолжать корректно функционировать. Зависания, перезагрузки и другие аналогичные «события» недопустимы.
2. Переход в защищенный режим процессора должен быть выполнен по алгоритму, используемому в процессорах начиная с 386. Переход в защищенный режим с использованием алгоритма для 286 процессора недопустим.


# Contributing

Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.

# Copyright

This repository is under exclusive copyright.

I do grant each User of GitHub a nonexclusive, worldwide license to use, display, and perform My Content through the GitHub Service and to reproduce My Content solely on GitHub as permitted through GitHub's functionality but that is all. No other licences are provided for Users of GitHub.

© All rights reserved, 2022
